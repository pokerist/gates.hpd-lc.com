{% extends "base.html" %}
{% block content %}
<section class="card hero">
  <div class="hero-row">
    <div>
      <h2>لوحة الأدمن</h2>
      <p>بحث وإدارة السجلات.</p>
    </div>
    <div>
      <button class="btn btn-outline" id="debugAccessBtn">Manual Debug</button>
    </div>
  </div>
</section>

<section class="card" style="margin-bottom: 16px;">
  <div class="grid" style="grid-template-columns: 1fr auto; align-items: end; gap: 12px;">
    <div>
      <label>بحث سريع</label>
      <input id="searchInput" type="text" placeholder="ابحث بالاسم أو الرقم القومي" />
    </div>
    <button class="btn btn-secondary" id="refreshBtn">تحديث</button>
  </div>
</section>

<section class="card issues-card" style="margin-bottom: 16px;">
  <div class="issues-header">
    <div>
      <h3>السجلات التي تحتاج إدخال يدوي</h3>
      <p>أي سجل ناقص الاسم أو الرقم القومي يظهر هنا تلقائياً.</p>
    </div>
    <div class="issues-meta">
      <span id="manualIssuesCount" class="badge warning">0</span>
      <span id="liveStatus" class="live-status">جاري الاتصال...</span>
    </div>
  </div>
  <div id="manualIssuesList" class="issues-list"></div>
</section>

<section class="card batch-card" style="margin-bottom: 16px;">
  <div class="batch-actions">
    <label class="batch-select">
      <input type="checkbox" id="selectAllRows" />
      تحديد الكل
    </label>
    <div class="batch-buttons">
      <button class="btn btn-outline btn-sm" id="rotateCcwBtn">لف يسار</button>
      <button class="btn btn-outline btn-sm" id="rotateCwBtn">لف يمين</button>
    </div>
    <div class="batch-count">
      المحدد: <span id="selectedCount">0</span>
    </div>
  </div>
</section>

<section class="card">
  <div class="table-wrap">
    <table class="table" id="peopleTable">
      <thead>
        <tr>
          <th>تحديد</th>
          <th>الصورة</th>
          <th>البطاقة</th>
          <th>الاسم</th>
          <th>الرقم القومي</th>
          <th>البوابة</th>
          <th>الحالة</th>
          <th>سبب الحظر</th>
          <th>مرات الدخول</th>
          <th>آخر دخول</th>
          <th>إجراءات</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</section>

<div id="cardPreviewBackdrop" class="preview-backdrop hidden"></div>
<aside id="cardPreviewPanel" class="preview-panel hidden" aria-hidden="true">
  <div class="preview-header">
    <h3>صورة البطاقة</h3>
    <button class="btn btn-outline preview-close" id="cardPreviewClose">إغلاق</button>
  </div>
  <div class="preview-body">
    <div class="preview-block">
      <h4>البطاقة الأصلية</h4>
      <img id="cardPreviewImage" alt="card preview" />
    </div>
    <div class="preview-block">
      <h4>صورة الوجه</h4>
      <img id="facePreviewImage" alt="face preview" />
    </div>
  </div>
</aside>

<div id="toastContainer" class="toast-container" aria-live="polite" aria-atomic="false"></div>
{% endblock %}

{% block scripts %}
<script src="/static/js/admin.js"></script>
{% endblock %}
